<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

    <div class="row" th:fragment="footer">
        <div class="col-xs-12"><!--Подвал--></div>
    </div>

    <th:block th:fragment="script">
<!--        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>-->
<!--        <script th:src="@{/js/bootstrap.min.js}"></script>-->

        <!-- Optional JavaScript; choose one of the two! -->

        <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!--        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

        <!-- Option 2: jQuery, Popper.js, and Bootstrap JS
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
        -->


            <script th:src="@{/js/my.js}"></script>
<!--         или-->
        <script>
            // <div class="modal fade" th:id="edit_+${user.getId()}" tabIndex="-1" role="dialog"
            //      aria-labelledby="exampleModalLabel" aria-hidden="true">
            //     <div className="modal-dialog" role="document">
            //         <div th:replace="/block/forms :: modalEditUserForm"></div>
            //     </div>
            // </div>
            function modalEdit(user, role) {
                //need function getAllRole()

            }

            function listUsers($) {
                getAllUsersJson( jQuery )
                    .then(function(users)
                    {
                        $('#allUsersTable').empty();
                        for(var i=0; i < users.length; i++ ){
                            let userRole = users[i].roles.map(
                                function (role) {
                                    return " " + role.name.replace("ROLE_", "")
                                });
                            $('<tr></tr>').append(
                                $("<th></th>").text( users[i].id ),
                                $("<td></td>").text( users[i].firstName ),
                                $("<td></td>").text( users[i].lastName ),
                                $("<td></td>").text( users[i].age ),
                                $("<td></td>").text( users[i].email ),
                                $("<td></td>").text( userRole ).prop( {id: role} ),
                                $("<td></td>").append( buttonEditUser(users[i]) ), //функция с параметрами (users[i], userRole)
                                $("<td></td>").append( buttonDeleteUser(users[i]) ) //функция с параметрами (users[i], userRole)
                            ).appendTo('#allUsersTable');
                        }
                    })
                    .catch(function(err){
                        console.log(err.message); //выведет сообщение "не удалось выполнить..."
                    });

            }


            $( document ).ready( authUserInfo ).ready( listUsers );
        </script>
    </th:block>

</html>


